<!DOCTYPE html>
<html lang="en" data-theme="light"> <!-- JS will overwrite to system choice -->

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SEC-COPILOT</title>

  <!-- in app/ui/web/index.html <head> -->
  <link rel="stylesheet" href="tailwind.css" />
  <link rel="stylesheet" href="style.css?v=20251004" />
  <link rel="stylesheet" href="style.css" />

  <!-- Match auth/reset fonts/icons -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,800" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">



  <!-- Auth gate -->
  <script>
    (function () {
      try {
        const token = localStorage.getItem('sec_token');
        if (!token) window.location.replace('/auth.html');
      } catch (_) { window.location.replace('/auth.html'); }
    })();
  </script>
  <noscript>
    <meta http-equiv="refresh" content="0;url=/auth.html">
  </noscript>
</head>

<body>
  <div class="layout">
    <!-- SIDEBAR -->
    <aside id="sidebar" class="sidebar">
      <div class="brand">
        <button id="closeSidebar" class="mobile-only" aria-label="Close Sidebar">☰</button>
        <span class="logo-dot"></span>
        <span class="brand-name">SEC-COPILOT</span>
      </div>

      <div class="side-actions">
        <button id="newChatBtn" class="btn primary">New chat</button>
        <div class="search">
          <input id="searchChats" placeholder="Search chats" />
        </div>
      </div>

      <div class="side-group">
        <div class="side-title">Projects</div>
        <div class="folder-actions">
          <input id="newFolderName" placeholder="New project" />
          <button id="addFolderBtn" class="btn small">+</button>
        </div>
        <ul id="foldersList" class="folders"></ul>
      </div>

      <div class="side-group">
        <div class="side-title">History</div>
        <ul id="historyList" class="history"></ul>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <!-- topbar -->
      <header class="topbar">
        <button id="openSidebar" class="mobile-only" aria-label="Open Sidebar">☰</button>
        <div class="crumbs">
          Home / <span id="convTitle">New conversation</span>
        </div>

        <div class="top-actions">
          <div class="theme-toggle">
            <!-- Theme toggle (compact, no overlap) -->
            <div class="toggleWrapper" id="themeToggleWrap">
              <span class="ampm am"></span>

              <input type="checkbox" class="dn" id="dn" />
              <label for="dn" class="toggle">
                <span class="toggle__handler">
                  <span class="crater crater--1"></span>
                  <span class="crater crater--2"></span>
                  <span class="crater crater--3"></span>
                </span>
                <span class="star star--1"></span>
                <span class="star star--2"></span>
                <span class="star star--3"></span>
                <span class="star star--4"></span>
                <span class="star star--5"></span>
                <span class="star star--6"></span>
              </label>

              <span class="ampm pm"></span>
            </div>

          </div>
          <button id="toggleTrace" class="btn">Show agent trace</button>
          <button id="logoutBtn" class="btn">Logout</button>
        </div>

      </header>

      <!-- chat stream -->
      <section id="messages" class="messages"></section>

      <!-- trace -->
      <section id="tracePanel" class="trace hidden">
        <div class="trace-head">
          <strong>Agent trace</strong>
        </div>
        <div id="traceSteps" class="trace-steps"></div>
      </section>

      <!-- composer -->
      <footer class="composer-wrap">
        <form id="composer" class="composer">
          <div class="plus-wrap">
            <button type="button" id="plusBtn" class="circle" aria-label="More actions">
              <span>+</span>
            </button>
            <div id="plusMenu" class="menu hidden">
              <button data-menu="files" type="button">Add files</button>
              <button data-menu="agent" type="button">Agent mode</button>
              <hr />
              <button data-menu="web" type="button">Web search</button>
            </div>
          </div>
          <input id="prompt" class="input" placeholder="Ask anything" />
          <button id="send" class="send circle" aria-label="Send">➤</button>
        </form>
      </footer>
    </main>
  </div>

  <div id="backdrop" class="backdrop hidden"></div>
  <script src="app.js"></script>

  <!-- Theme init (in case app.js loads slow); app.js also binds events -->
  <script>
    (function () {
      const KEY = 'sec_theme';
      function detectSystem() {
        return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }
      const saved = localStorage.getItem(KEY);
      const initial = saved || detectSystem();
      document.documentElement.setAttribute('data-theme', initial);
      // reflect switch
      const cb = document.getElementById('dn');
      if (cb) cb.checked = initial === 'dark';
    })();
  </script>
</body>

</html>